<%- include('../navigation/header') %>
<div class="row">
    <div class="col-lg-2 col-md-12 desktop-view">
        <div id="accordion">
            <!-- <div class="card">
                <div class="card-header" id="headingzero">
                    <h5 class="mb-0">
                        <a href="/admin/news" class="btn btn-link">
                            <span><i class="fab fa-dyalog"></i></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span id="ads-text">Dashboard</span>
                        </a>
                    </h5>
                </div>
            </div> -->
            <% if(role_id == 1 || role_id == 2){%>
                <div class="card">
                    <div class="card-header" id="headingTwo">
                        <h5 class="mb-0">
                            <button class="btn btn-link collapsed" data-toggle="collapse" data-target="#collapseTwo" aria-expanded="false" aria-controls="collapseTwo">
                                <span id="admin_icon"><i class="fas fa-user-tie"></i></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span id="admin-text">Users<i class="fas fa-caret-down" style="margin-left: 10px"></i></span>
                            </button>
                        </h5>
                    </div>
                    <div id="collapseTwo" class="collapse" aria-labelledby="headingTwo" data-parent="#accordion">
                        <div class="card-body">
                            <div class="list-group">
                                    <a href="/admin/users" class="list-group-item list-group-item-action">
                                        All Users
                                    </a>
                                    <a href="/admin/add-user" class="list-group-item list-group-item-action">Create User</a>
                            </div>
                        </div>
                    </div>
                </div>
            <%}%>
            <div class="card">
                <div class="card-header" id="headingFour">
                    <h5 class="mb-0">
                        <button class="btn btn-link collapsed" data-toggle="collapse" data-target="#collapseFour" aria-expanded="false" aria-controls="collapseFour">
                            <span id="news_icon"><i class="far fa-newspaper"></i></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span id="news-text">News<i class="fas fa-caret-down" style="margin-left: 10px"></i></span>
                        </button>
                    </h5>
                </div>
                <div id="collapseFour" class="collapse" aria-labelledby="headingFour" data-parent="#accordion">
                    <div class="card-body">
                        <div class="list-group">
                            <a href="/admin/add-news" class="list-group-item list-group-item-action">Create News</a>
<a href="/admin/news" class="list-group-item list-group-item-action">
                                My News
                            </a>

                            <% if(role_id == 1 || role_id == 2){%>
                                <a href="/admin/admin-news" class="list-group-item list-group-item-action">
                                    Admin News
                                </a>
                                <a href="/admin/reporter-news" class="list-group-item list-group-item-action">
                                    Reporter News
                                </a>
                                <a href="/admin/user-news" class="list-group-item list-group-item-action">
                                    User News
                                </a>
                                <a href="/admin/tags" class="list-group-item list-group-item-action">
                                    Tags
                                </a>
                                <a href="/admin/pool" class="list-group-item list-group-item-action">
                                    Pool
                                </a>
                                <a href="/admin/categories" class="list-group-item list-group-item-action">
                                    All State,City,District
                                </a>
                                <a href="/admin/add-category" class="list-group-item list-group-item-action">Create State,City,District</a>
                            <%}%>
                            
                        </div>
                    </div>
                </div>
            </div>
            <% if(role_id == 1 || role_id == 2){%>
                <div class="card">
                    <div class="card-header" id="headingSix">
                        <h5 class="mb-0">
                            <a href="/admin/slider" class="btn btn-link">
                                <span id="banner_icon"><i class="fas fa-image"></i></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span id="banner-text">Slider</span>
                            </a>
                        </h5>
                    </div>
                </div>
                <div class="card">
                    <div class="card-header" id="headingSeven">
                        <h5 class="mb-0">
                            <a href="/admin/ads" class="btn btn-link">
                                <span id="ads_icon"><i class="fas fa-ad"></i></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span id="ads-text">Ads</span>
                            </a>
                        </h5>
                    </div>
                </div> 
                <div class="card">
                    <!-- <div class="card-header" id="headingNine">
                        <h5 class="mb-0">
                            <button class="btn btn-link collapsed" data-toggle="collapse" data-target="#collapseNine" aria-expanded="false" aria-controls="collapseNine">
                                <span id="dr_icon"><i class="fas fa-folder"></i></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span id="dr-text">Directory<i class="fas fa-caret-down" style="margin-left: 10px"></i></span>
                            </button>
                        </h5>
                    </div> -->
                    <div id="collapseNine" class="collapse" aria-labelledby="headingNine" data-parent="#accordion">
                        <div class="card-body">
                            <div class="list-group">
                                <a href="/admin/posts" class="list-group-item list-group-item-action">
                                    My Posts
                                </a>
                                <a href="/admin/forms" class="list-group-item list-group-item-action">
                                    Forms
                                </a>
                                    <a href="/admin/add-dcategory" class="list-group-item list-group-item-action">
                                        All State,City,District
                                    </a>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="card">
                    <div class="card-header" id="headingTen">
                        <h5 class="mb-0">
                            <button class="btn btn-link collapsed" data-toggle="collapse" data-target="#collapseTen" aria-expanded="false" aria-controls="collapseTen">
                                <span id="dr_icon"><i class="fas fa-copy"></i></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span id="dr-text">E-paper<i class="fas fa-caret-down" style="margin-left: 10px"></i></span>
                            </button>
                        </h5>
                    </div>
                    <div id="collapseTen" class="collapse" aria-labelledby="headingTen" data-parent="#accordion">
                        <div class="card-body">
                            <div class="list-group">
                                <a href="/admin/e-paper" class="list-group-item list-group-item-action">
                                    My E-papers
                                </a>
                                    <a href="/admin/add-epaper-category" class="list-group-item list-group-item-action">
                                        Create epaper-category
                                    </a>
                            </div>
                        </div>
                    </div>
                </div>
            <%}%>
        </div>
    </div>
    <div class="col-lg-10 col-md-12" style="overflow-y: scroll;height: 90vh;">

<div class="container-fluid" style="background-color: white;width: 100%;padding: 0px;border-radius: 10px;box-shadow: 0px 0px 12px rgba(0,0,0,0.1);">
    <div class="row">
        <div class="col-lg-12 col-md-12" style="padding: 25px 20px 30px 35px">
            <h5 style="font-weight: bold;letter-spacing: 1px;text-align: center">Create News</h5>
            <br>
            <form action="/admin/add-news-notlogged" method="post" enctype="multipart/form-data">
                <div class="row">
                    <div class="col-lg-3 col-md-12">
                        <div class="form-group">
                            <label for="" >State</label>
                            <%if(role_id == 3){%>
                                <%if(categories.length != 0){%>
                                <select class="form-control" name="c" id="c" required>
                                    <option value="<%= categories[0].name + '_' + categories[0].id %>"><%= categories[0].name %></option>
                                </select>
                                <%} else {%>
                                <select class="form-control" name="c" id="c" required>
                                    <option value="राजस्थान_12">राजस्थान</option>
                                </select>
                                <%}%>
                            <%} else {%>
                                <select class="form-control" name="c" id="c" required>
                                    <option value="">Select State</option>
                                    <% for(var i=0;i<categories.length;i++){ %>
                                    <%if(categories[i].name != null){%>
                                        <option value="<%= categories[i].name + '_' + categories[i].id %>"><%= categories[i].name %></option>
                                    <% } %>
                                    <% } %>
                                </select>
                            <%}%>
                        </div>
                    </div>
                    <div class="col-lg-3 col-md-12">
                        <div class="form-group">
                            <label for="">City</label>
                            <%if(role_id == 3){%>
                                <%if(subcategories.length != 0){%>
                                    <%if(subcategories[0].name.includes('(')){%>
                                        <select class="form-control" name="sc" id="sc" required>
                                            <option value="<%= (subcategories[0].name.split('(')[1]).split(')')[0] %>"><%= (subcategories[0].name.split('(')[1]).split(')')[0] %></option>
                                        </select>
                                    <%} else {%>
                                        <select class="form-control" name="sc" id="sc" required>
                                            <option value="<%= (subcategories[0].name) %>"><%= (subcategories[0].name) %></option>
                                        </select>
                                    <%}%>
                                <%} else {%>
                                    <select class="form-control" name="sc" id="sc" required>
                                        <option value="0">other</option>
                                    </select>
                                <%}%>
                            <%} else {%>
                                <select class="form-control" name="sc" id="sc" required>
                                    <option value="">Select City</option>
                                </select>
                            <%}%>
                        </div>
                    </div>
                    <div class="col-lg-3 col-md-12">
                        <div class="form-group">
                            <label for="" >District</label>
                            <%if(role_id == 3){%>
                                <%if(subcategories.length != 0){%>
                                    <%if(subcategories[0].name.includes('(')){%>
                                        <select class="form-control" name="district" id="district" required>
                                            <option value="<%= subcategories[0].name %>"><%= (subcategories[0].name.split('(')[0]) %></option>
                                        </select>
                                    <%} else {%>
                                        <select class="form-control" name="district" id="district" required>
                                            <option value="<%= (subcategories[0].name + ' क्षेत्र') %>"><%= (subcategories[0].name + ' क्षेत्र') %></option>
                                        </select>
                                    <%}%>
                                <%} else {%>
                                    <select class="form-control" name="district" id="district" required>
                                        <option value="0">other</option>
                                    </select>
                                <%}%>
                            <%} else {%>
                                <select class="form-control" name="district" id="district" required>
                                    <option value="">Select Tehsil</option>
                                </select>
                            <%}%>
                        </div>
                    </div>
                    <div class="col-lg-3 col-md-12">
                        <div class="form-group">
                            <label for="" >Tags</label>
                                <select class="form-control" name="tags" id="tags" required>
                                    <option value="">Select a tag</option>
                                    <% for(var i=0;i<tags.length;i++){ %>
                                    <%if(tags[i].name != null){%>
                                        <option value="<%= tags[i].name %>"><%= tags[i].name %></option>
                                    <% } %>
                                    <% } %>
                                </select>
                        </div>
                    </div>
                </div>



                <div class="row">
                    <div class="col-lg-12 col-md-12">
                        <!-- <div class="form-group">
                            <label for="">Title</label>
                            <input type="text" class="form-control" id="title" name="title" placeholder="Enter Title" required>
                        </div> -->
                    </div>
                    <div class="col-lg-12 col-md-12" style="display: none">
                        <label for="">Status</label>
                        <br>
                        <div class="form-check form-check-inline">
                            <input class="form-check-input" type="radio" name="status" id="inlineRadio0" value=1 checked>
                            <label class="form-check-label" for="inlineRadio0">Active</label>
                        </div>
                        <div class="form-check form-check-inline">
                            <input class="form-check-input" type="radio" name="status" id="inlineRadio01" value=0>
                            <label class="form-check-label" for="inlineRadio01">Deactive</label>
                        </div>
                    </div>
                </div>

                <div class="row">
                    <div class="col-lg-12 col-md-12">
                        <div class="form-group">
                            <label for="">Title</label>
                            <textarea type="text" class="form-control" id="sd" name="sd" placeholder="Enter Title" maxlength="140" rows="4" required></textarea>
                        </div>
                    </div>
                </div>

                <input type="hidden" name="admin_id" value=<%=admin_id%>>

                <div class="form-group">
                    <label for="">Content</label>
                    <textarea name="ta" class="form-control" id="ta" cols="30" rows="8" placeholder="Content" required></textarea>
                </div>

                <div class="row">
                    <div class="col-lg-6 col-sm-12">
                        <label for="">Add Images(Select Multiple Images)</label>
                        <div class="row" id="imagegroup">
                            <div class="col-lg-6 col-md-12">
                                <div class="row">
                                    <div class="col-10">
                                        <div class="form-group">
                                            <input type="file" class="form-control-file" name="images" id="img" accept="image/x-png,image/gif,image/jpeg" onchange="showPreview('image-preview',this.files)">
                                        </div>
                                    </div>
                                    <div class="col-2">
                                        <a onclick="addimage()" style="text-decoration: none;font-size: 1.5rem"><i class="fas fa-plus-circle"></i></a>
                                    </div>
                                    <div class="col-12" style="padding: 15px">
                                        <img src="" alt="" id="image-preview" style="width: 100%">
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-lg-6 col-md-12">
                        <div class="form-group" id="videogroup">
                            <label for="">Add Videos(Add multiple URLs)</label><br>
                            <button type="button" id="url" style="border: 1px solid #707070; border-radius: 3px" data-toggle="modal" data-target="#video">Add url</button>

                            <div id="videos">

                            </div>

                            <!-- Modal -->
                            <div class="modal fade" id="video" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
                                <div class="modal-dialog modal-dialog-centered" role="document">
                                    <div class="modal-content">
                                        <div class="modal-header">
                                            <h5 class="modal-title" id="exampleModalLongTitle">Video Url</h5>
                                            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                                <span aria-hidden="true">&times;</span>
                                            </button>
                                        </div>
                                        <div class="modal-body" id="addvideourl">
                                            <div class="row">
                                                <div class="col-10">
                                                    <div class="form-group">
                                                        <input type="url" class="form-control url" name="url" placeholder="Enter url">
                                                    </div>
                                                </div>
                                                <div class="col-2">
                                                    <a onclick="addvideourl()" style="text-decoration: none;font-size: 1.5rem"><i class="fas fa-plus-circle"></i></a>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="modal-footer">
                                            <button type="button" onclick="previewVideo()" class="btn btn-primary" data-dismiss="modal">Save changes</button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <%if (role_id == 1){%>

                <div class="jumbotron text-center">
                    <a href="<%=url%>" class="btn btn-danger"><span class="fa fa-google-plus"></span> Login or Register with Google Account</a>
                </div>

                <%}%>

                <br><br>
                <div class="container" style="width: 50%;text-align: center">
                    <button type="submit" id="verify" class="btn btn-primary" style="width: 100%;background-color: #556ee6">Create</button>
                </div>
            </form>

            <br>
        </div>
    </div>
</div>
    </div>
</div>


<% for(var i=0;i<subcategories.length;i++){ %>
<input type="hidden" name="" id="subcategoriesName<%=i%>" value="<%=subcategories[i].name%>">
<input type="hidden" name="" id="subcategoriesId<%=i%>" value="<%=subcategories[i].id%>">
<input type="hidden" name="" id="subcategoriesCat<%=i%>" value="<%=subcategories[i].category_id%>">
<%}%>
<input type="hidden" name="" id="subcatlength" value=<%=subcategories.length%>>
<script>

    var count1 = 0;
    function addimage(){
        $('#imagegroup').append('<div class="col-lg-6 col-md-12" id="i'+count1+'"><div class="row"><div class="col-10" ><div class="form-group"><input type="file" class="form-control-file" name="images" accept="image/x-png,image/gif,image/jpeg" onchange="showPreview(\'image-preview'+count1+'\',this.files)"></div></div><div class="col-2"><a onclick="deleteimage('+count1+')" style="text-decoration: none;font-size: 1.5rem;color: #DC3545"><i class="fas fa-times-circle"></i></a></div><div class="col-12" style="padding: 15px"><img src="" alt="" id="image-preview'+count1+'" style="width: 100%"></div></div></div>');
        count1++;
    }

    function deleteimage(i){
        var a = '#i' + i;
        $(a).remove();
    }

    function showPreview(id,files){
        if(files) {
            var reader = new FileReader();

            reader.onload = function(event) {
                $('#'+ id).attr('src',event.target.result);
            }
            reader.readAsDataURL(files[0]);
        }
    }

    function previewVideo() {
        document.getElementById('videos').innerHTML = "";
        var inputs = $('.url');
        console.log(inputs);
        for(var i=0;i<inputs.length;i++){
            var regExp = /^.*((youtu.be\/)|(v\/)|(\/u\/\w\/)|(embed\/)|(watch\?))\??v?=?([^#&?]*).*/;
            var match = (inputs[i].value).match(regExp);
            var str = (match&&match[7].length==11)? match[7] : false;
            $('#videos').append('<iframe src="https://www.youtube.com/embed/'+ str +'" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>');
        }
    }

    var count = 0;
    function addvideourl(){
        $('#addvideourl').append('<div class="row" id="d'+count+'"><div class="col-10"><div class="form-group"><input type="text" class="form-control url" name="url" placeholder="Enter url"></div></div><div class="col-2"><a  onclick="deletevideourl('+count+')" style="text-decoration: none;font-size: 1.5rem;color: #DC3545"><i class="fas fa-times-circle"></i></div></div>');
        count++;
    }

    function deletevideourl(i){
        var a = '#d' + i;
        $(a).remove();
    }

    var subcatlength = document.getElementById('subcatlength').value;
    
    $('#c').change(function(){
        var a = this.value.split('_')[1];
        var select = document.getElementById("sc");
        var length = select.options.length;
        for (var i = length-1; i >= 0; i--) {
            select.options[i] = null;
        }
        var b = 0;
        var option = document.createElement("option");
        option.text = 'Select City';
        option.value= '';
        select.add(option);
        for(var i = 0;i<subcatlength;i++){
            var subcategoriesName = document.getElementById('subcategoriesName'+i).value;
            var subcategoriesCat = parseInt(document.getElementById('subcategoriesCat'+i).value);
            if(subcategoriesCat == a){
                if(!subcategoriesName.includes('(')){
                    var option = document.createElement("option");
                    option.text = subcategoriesName;
                    option.value= subcategoriesName;
                    select.add(option);
                    b++;
                }
            }
        }
        if(b==0){
            var option = document.createElement("option");
            option.text = "No City present";
            option.value= '0';
            select.add(option);
        }
    });

    $('#sc').change(function(){
        var a = this.value;
        var select = document.getElementById("district");
        var length = select.options.length;
        for (var i = length-1; i >= 0; i--) {
            select.options[i] = null;
        }
        var b = 0;
        var option = document.createElement("option");
        option.text = 'Select District';
        option.value= '';
        select.add(option);
        if(a != '0'){
            var option2 = document.createElement("option");
            option2.text = a + ' क्षेत्र';
            option2.value= a + ' क्षेत्र';
            select.add(option2);
            b++;
        }
        for(var i = 0;i<subcatlength;i++){
            var subcategoriesName = document.getElementById('subcategoriesName'+i).value;
            if(subcategoriesName.includes('(' + a + ')')){
                var option = document.createElement("option");
                option.text = subcategoriesName.split('(')[0];
                option.value= subcategoriesName;
                select.add(option);
                b++;
            }
        }
        if(b==0){
            var option = document.createElement("option");
            option.text = "No District present";
            option.value= '0';
            select.add(option);
        }
    });
</script>

<%- include('../navigation/footer') %>